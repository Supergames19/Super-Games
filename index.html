<!DOCTYPE html>
<html lang="id">

<head>
    <meta name="robots" content="noindex, nofollow">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Link ke Manifest -->
    <link rel="manifest" href="./manifest.json">

    <!-- Warna Tema untuk Browser di Mobile -->
    <meta name="theme-color" content="#28a745">

    <title>Peraturan & Ketentuan Toko</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background-color: #f4f4f4;
            padding: 15px;
        }

        .container {
            background-color: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            text-align: center;
            width: 90%;
            max-width: 500px;
        }

        h1 {
            color: #1a1919;
            font-size: 1.8em;
            margin-bottom: 15px;
        }

        p {
            color: #1f1e1e;
            line-height: 1.6;
            font-size: 1em;
        }

        .persetujuan {
            margin-top: 25px;
            text-align: left;
            display: flex;
            align-items: center;
        }

        .persetujuan input[type="checkbox"] {
            margin-right: 10px;
            width: 18px;
            height: 18px;
        }

        .tombol-masuk {
            display: inline-block;
            background-color: #28a745;
            color: white;
            padding: 12px 25px;
            border: none;
            border-radius: 5px;
            font-size: 16px;
            font-weight: bold;
            text-decoration: none;
            cursor: pointer;
            margin-top: 25px;
            transition: background-color 0.3s, transform 0.2s;
            width: 100%;
            max-width: 250px;
        }

        .tombol-masuk:hover {
            background-color: #218838;
            transform: scale(1.05);
        }

        .tombol-masuk.disabled {
            background-color: #cccccc;
            color: #666666;
            cursor: not-allowed;
            pointer-events: none;
            transform: none;
        }

        @media (max-width: 480px) {
            .container {
                padding: 20px;
            }

            h1 {
                font-size: 1.5em;
            }

            p,
            label {
                font-size: 0.9em;
            }
        }

        /* Tambahkan di akhir CSS Anda */
        .update-notification {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background-color: #333;
            color: white;
            padding: 15px 25px;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
            z-index: 1000;
            display: none;
            /* Sembunyi secara default */
            align-items: center;
        }

        .update-notification p {
            margin: 0;
            padding-right: 20px;
            color: white;
        }

        .update-notification button {
            background-color: #28a745;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
        }

        /* ... Kode CSS Anda yang sudah ada ... */

        /* [TAMBAHKAN INI] GAYA UNTUK PROMPT INSTALASI KUSTOM */
        .install-prompt {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background-color: #007bff;
            /* Warna biru yang menarik perhatian */
            color: white;
            padding: 15px 25px;
            border-radius: 12px;
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.25);
            z-index: 2000;
            /* Pastikan di atas notifikasi update */
            display: flex;
            align-items: center;
            justify-content: space-between;
            width: 90%;
            max-width: 500px;
            transition: transform 0.3s ease-in-out;
        }

        .install-prompt.hidden {
            display: none;
        }

        .install-prompt p {
            margin: 0;
            padding-right: 20px;
            color: white;
            font-weight: 500;
        }

        .tombol-install {
            background-color: #ffffff;
            color: #007bff;
            border: none;
            padding: 10px 18px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            white-space: nowrap;
            /* Mencegah teks tombol terpotong */
            transition: background-color 0.2s;
        }

        .tombol-install:hover {
            background-color: #f0f0f0;
        }
    </style>
</head>

<body>
    <noscript>
        <style>
            /* Sembunyikan semua konten jika JS mati */
            body>*:not(noscript) {
                display: none !important;
            }
        </style>
        <div style="text-align: center; padding: 50px; font-family: sans-serif;">
            <h1>Maaf Tidak Di izinkan</h1>
            <p>Situs ini Sudah Di kunci.</p>
        </div>
    </noscript>
    <div id="install-container" class="install-prompt hidden">
        <p>Install Aplikasi Toko Super Games untuk pengalaman terbaik!</p>
        <button id="install-button" class="tombol-install">Install Sekarang</button>
    </div>

    <div class="container">
        <h1>SELAMAT DATANG</h1>
        <h2>Peraturan & Ketentuan Toko</h2>
        </br>
        <p>
            Untuk kenyamanan bersama, mohon luangkan waktu sejenak untuk membaca peraturan toko kami sebelum Anda
            melanjutkan.
        </p>
        <div style="text-align: left; border-top: 1px solid #000000; padding-top: 15px; margin-top: 15px; ">
            <h3 style="margin-bottom: 10px; text-align: center;">Poin Penting Sebelum Belanja</h3>
            <ul style="padding-left: 20px; color: #3a3a3a;">
                <li style="margin-bottom: 8px;">
                    <strong>Pemesanan:</strong> Pastikan alamat dan detail pesanan sudah benar sebelum membayar.
                    Kesalahan di luar tanggung jawab kami.
                </li>
                <li style="margin-bottom: 8px;">
                    <strong>Pengiriman:</strong> Pesanan akan kami proses dalam 1-2 hari kerja setelah pembayaran
                    dikonfirmasi.
                </li>
                <li style="margin-bottom: 8px;">
                    <strong>Komplain & Retur:</strong> Wajib menyertakan bukti <strong>video unboxing</strong> tanpa
                    jeda dari awal paket masih tersegel. Tanpa video, komplain tidak dapat kami proses.
                    <strong>Lalu Kirim ke Whatsapp Kami 0823 6713 6420</strong>
                </li>
            </ul>
        </div>
        <div style="text-align: left; border-top: 1px solid #eee; padding-top: 15px; margin-top: 15px;">
            <h3 style="margin-bottom: 10px; text-align: center;">Peraturan Belanja</h3>
            <ol style="padding-left: 20px; color: #3a3a3a; line-height: 1.6;">
                <li style="margin-bottom: 10px;">
                    <strong>Jam Operasional:</strong> Senin - Sabtu, 08.30 - 17:00 WIB. Pesanan di luar jam tersebut
                    akan diproses pada hari kerja berikutnya.
                </li>
                <li style="margin-bottom: 10px;">
                    <strong>Proses Pembayaran & Pengiriman:</strong> Pembayaran yang terverifikasi sebelum pukul 15:00
                    akan diusahakan dikirim di hari yang sama. Kami tidak bertanggung jawab atas keterlambatan yang
                    disebabkan oleh pihak kurir.
                </li>
                <li style="margin-bottom: 10px;">
                    <strong>Ketentuan Komplain:</strong> Segala bentuk komplain mengenai kekurangan atau kerusakan
                    produk wajib disertai bukti video unboxing dari awal paket masih tersegel hingga selesai diperiksa,
                    tanpa terpotong. Batas komplain adalah 1x24 jam setelah barang diterima.
                </li>
            </ol>
        </div>

        <div style="text-align: left; border-top: 1px solid #eee; padding-top: 15px; margin-top: 15px;">
            <h3 style="margin-bottom: 10px; text-align: center;">Hai Kak, Yuk Simak Dulu!</h3>
            <ul style="padding-left: 20px; color: #3a3a3a;; list-style-type: 'âœ… '; /* Emoji sebagai bullet */">
                <li style="margin-bottom: 8px;">
                    <strong>Cek Pesananmu:</strong> Sebelum checkout, pastikan detail pesanannya <strong>Cocok</strong>
                    dan
                    alamat kamu sudah 100% benar ya, agar paket cepat sampai tujuan!
                </li>
                <li style="margin-bottom: 8px;">
                    <strong>Proses Kilat:</strong> Tim kami akan langsung memproses pesanan kamu setelah pembayaran.
                    Mohon
                    bersabar menunggu resi yang akan kami Kirimkan Berbentuk JPG sesuai dengan Jasa Pengiriman Yang Kita
                    pakai, ke aplikasih Ini diBagian Pesanan.
                </li>
                <li style="margin-bottom: 8px;">
                    <strong>Jika Ada Kendala:</strong> Jangan khawatir! Cukup rekam video unboxing paket kamu (dari awal
                    sampai akhir, tanpa jeda) dan kirimkan ke kami. Tim kami siap membantu!
                </li>
            </ul>
        </div>

        <div class="persetujuan">
            <input type="checkbox" id="setuju" name="setuju">
            <label for="setuju">Saya telah membaca dan setuju dengan peraturan yang berlaku.</label>
        </div>

        <!-- GANTI 'halaman-utama.html' dengan link tujuan Anda (maintens.html)-->
        <a href="https://b32557f75d35.ngrok-free.app" id="tombolMasuk" class="tombol-masuk disabled">
            Masuk
        </a>
    </div>
    <!-- Taruh ini sebelum </body> -->
    <div id="updateNotification" class="update-notification">
        <p>Versi baru tersedia!</p>
        <button id="reloadButton">Muat Ulang</button>
    </div>

    <script>
        /**
     * Fungsi ini akan mencoba "ping" URL tujuan.
     * Jika berhasil, akan redirect ke URL tersebut.
     * Jika gagal (timeout atau error), akan redirect ke halaman maintenance.
     * @param {string} urlTujuan - URL yang ingin dicek dan dituju.
     */
        async function cobaRedirect(urlTujuan) {
            const halamanMaintenance = './maintens.html';

            // Tampilkan pesan di console untuk debugging
            console.log(`Mencoba menghubungi ${urlTujuan}...`);

            // Gunakan AbortController untuk membuat timeout manual
            const controller = new AbortController();
            const timeoutId = setTimeout(() => {
                controller.abort();
                console.log('Request timeout.');
            }, 5000); // Timeout setelah 5 detik

            try {
                // Coba fetch dengan mode 'no-cors' agar tidak error karena kebijakan CORS Ngrok.
                // Kita tidak butuh responsnya, hanya ingin tahu apakah server merespons.
                await fetch(urlTujuan, {
                    method: 'HEAD', // HEAD lebih ringan dari GET, hanya minta header
                    signal: controller.signal,
                    mode: 'no-cors'
                });

                // Jika fetch berhasil, batalkan timeout dan redirect ke tujuan
                clearTimeout(timeoutId);
                console.log('Koneksi berhasil. Mengalihkan...');
                window.location.href = urlTujuan;

            } catch (error) {
                // Jika fetch gagal (karena timeout, network error, server down)
                clearTimeout(timeoutId);
                console.error('Koneksi gagal atau server tidak merespons. Mengalihkan ke halaman maintenance.', error);
                window.location.href = halamanMaintenance;
            }
        }


        // --- Definisikan halaman tujuan di satu tempat ---
        const halamanTujuan = 'https://b32557f75d35.ngrok-free.app';

        // --- LOGIKA REDIRECT PENGUNJUNG KEMBALI ---
        (function () {
            if (localStorage.getItem('persetujuanDiberikan') === 'true') {
                // Panggil fungsi pengecekan, bukan redirect langsung
                cobaRedirect(halamanTujuan);
            }
        })();

        // --- LOGIKA TOMBOL PERSETUJUAN ---
        const checkboxSetuju = document.getElementById('setuju');
        const tombolMasuk = document.getElementById('tombolMasuk');
        // tombolMasuk.href = halamanTujuan; // Baris ini tidak perlu karena href sudah ada di HTML
        checkboxSetuju.addEventListener('change', function () {
            tombolMasuk.classList.toggle('disabled', !this.checked);
        });
        // --- LOGIKA TOMBOL PERSETUJUAN ---
        // ... (baris checkbox tidak berubah) ...
        tombolMasuk.addEventListener('click', function (event) {
            // Selalu cegah aksi default dari link <a> agar kita bisa mengontrolnya
            event.preventDefault();

            if (checkboxSetuju.checked) {
                localStorage.setItem('persetujuanDiberikan', 'true');
                // Panggil fungsi pengecekan kita
                cobaRedirect(halamanTujuan);
            } else {
                // Jika tidak dicentang, tidak melakukan apa-apa
                console.log('Checkbox harus dicentang.');
            }
        });

        // --- LOGIKA PWA UPDATE NOTIFICATION ---
        let newWorker;
        function showUpdateNotification() {
            const notification = document.getElementById('updateNotification');
            const reloadButton = document.getElementById('reloadButton');
            notification.style.display = 'flex';
            reloadButton.addEventListener('click', () => {
                newWorker.postMessage({ action: 'skipWaiting' });
            });
        }
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('./sw.js').then(reg => {
                if (reg.waiting) {
                    newWorker = reg.waiting;
                    showUpdateNotification();
                    return;
                }
                reg.addEventListener('updatefound', () => {
                    newWorker = reg.installing;
                    newWorker.addEventListener('statechange', () => {
                        if (newWorker.state === 'installed' && navigator.serviceWorker.controller) {
                            showUpdateNotification();
                        }
                    });
                });
            }).catch(error => {
                console.log('Registrasi Service Worker gagal:', error);
            });
            let refreshing;
            navigator.serviceWorker.addEventListener('controllerchange', () => {
                if (refreshing) return;
                window.location.reload();
                refreshing = true;
            });
        }

        // --- LOGIKA PROMPT INSTALASI KUSTOM ---
        let deferredPrompt;
        const installContainer = document.getElementById('install-container');
        const installButton = document.getElementById('install-button');

        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
            installContainer.classList.remove('hidden');
        });

        installButton.addEventListener('click', async () => {
            installContainer.classList.add('hidden');
            if (deferredPrompt) {
                deferredPrompt.prompt();
                const { outcome } = await deferredPrompt.userChoice;
                console.log(`Respons pengguna: ${outcome}`);
                deferredPrompt = null;
            }
        });

        window.addEventListener('appinstalled', () => {
            console.log('Aplikasi berhasil di-install!');
            installContainer.classList.add('hidden');
            deferredPrompt = null;
        });

    </script>

    <!-- Script ini biarkan terpisah jika memang ada -->
    <script src="main.js" defer></script>

</body>

</html>
